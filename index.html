<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ‰‹ç¹ªâ¤ç¥ç¦ä¼¼é¡ç¹ª | Official Commission</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Noto Sans TC (é»‘é«”) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            /* ä¸»è‰²èª¿ï¼šæ·±æµ·è— */
            --primary: #0c4a6e;    
            --text-main: #1e293b;   
            
            /* èƒŒæ™¯ï¼šæ¥µæ·ºè— */
            --bg-color: #f0f9ff;   
            --card-bg: #ffffff;    
            
            /* é‡é»è‰²ï¼šè±¹è±¹æ¡ƒç²‰ç´… (å¼·åˆ¶å¯«æ­») */
            --accent-pink: #ff5fab; 
            --accent-light: #fff0f7;
            
            /* åŒ¯æ¬¾è³‡è¨Šå°ˆç”¨æ·¡è—è‰² */
            --bank-bg: #f0f9ff;
            --bank-border: #bae6fd;
            --bank-text: #0284c7;
        }
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#e0f2fe 2px, transparent 2px);
            background-size: 24px 24px;
            color: var(--text-main);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
            box-sizing: border-box;
        }

        /* å°è¦½åˆ— */
        .nav-glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 95, 171, 0.2);
        }

        /* å°è¦½åˆ—æŒ‰éˆ• */
        .nav-btn {
            cursor: pointer;
            transition: all 0.3s;
            color: #64748b;
            font-weight: 500;
        }
        .nav-btn:hover { color: var(--accent-pink); }
        .nav-btn.active {
            color: var(--accent-pink);
            font-weight: bold;
            position: relative;
        }
        .nav-btn.active::after {
            content: '';
            display: block;
            width: 100%;
            height: 2px;
            background: var(--accent-pink);
            position: absolute;
            bottom: -4px;
            left: 0;
        }

        /* Hero */
        .hero-section {
            padding: 60px 20px 80px 20px;
            text-align: center;
        }

        /* åˆ†é åˆ‡æ›æ§åˆ¶ */
        .page-section {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease-in;
        }
        .page-section.active {
            display: block;
            opacity: 1;
        }

        /* ä½œå“é›†å®¹å™¨ */
        .portfolio-container {
            width: 92% !important;
            max-width: 1000px !important;
            margin: 0 auto 60px auto !important;
        }
        
        /* ä½œå“å¡ç‰‡ */
        .work-card {
            background: #fff;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(12, 74, 110, 0.05);
            transition: all 0.3s;
            border: 2px solid transparent;
            cursor: pointer;
        }
        .work-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 95, 171, 0.15);
            border-color: var(--accent-pink);
        }
        .work-img {
            width: 100%;
            height: 300px;
            object-fit: cover;
            background-color: #e0f2fe;
        }

        /* è¡¨å–®å®¹å™¨ */
        .form-container {
            width: 92% !important;
            max-width: 800px !important;
            margin-left: auto !important;
            margin-right: auto !important;
            margin-top: -40px !important;
            margin-bottom: 120px !important;
            background: var(--card-bg);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(12, 74, 110, 0.06);
            padding: 30px 20px !important;
            position: relative;
            z-index: 10;
            border: 2px solid #fff;
            box-sizing: border-box !important;
        }

        /* è¼¸å…¥æ¡†ç¾åŒ– */
        .site-input {
            display: block;
            width: 100% !important;
            min-width: 0 !important;
            max-width: 100% !important;
            padding: 12px 16px;
            background-color: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            transition: all 0.3s;
            color: var(--text-main);
            font-size: 16px;
            box-sizing: border-box !important;
            -webkit-appearance: none;
            appearance: none;
        }
        .site-input:focus {
            outline: none;
            border-color: var(--accent-pink) !important;
            background-color: #fff;
            box-shadow: 0 0 0 4px rgba(255, 95, 171, 0.15);
            position: relative; 
            z-index: 5; 
        }

        /* éŒ¯èª¤ç‹€æ…‹çš„è¼¸å…¥æ¡† */
        .input-error {
            border-color: #ef4444 !important;
            background-color: #fef2f2 !important;
            animation: shake 0.4s ease-in-out;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* è¨‚å–®å¡ç‰‡ */
        .order-card {
            background: #fff;
            border: 2px solid var(--accent-pink) !important; 
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.02);
            transition: transform 0.2s, box-shadow 0.2s;
            overflow: visible !important; 
            box-sizing: border-box !important; 
        }
        
        .order-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 95, 171, 0.15);
        }

        /* è¨ˆæ•¸å™¨æŒ‰éˆ• */
        .qty-btn {
            width: 40px; height: 40px;
            border-radius: 50%; border: 2px solid #e2e8f0;
            background: white; color: var(--text-main);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; font-weight: bold; font-size: 1.2rem;
            transition: all 0.2s; user-select: none;
        }
        .qty-btn:active, .qty-btn:hover {
            background: var(--accent-pink); border-color: var(--accent-pink); color: #fff;
        }

        /* åº•éƒ¨æµ®å‹•æ¢ */
        .bottom-bar {
            position: fixed; bottom: 20px; left: 20px; right: 20px;
            margin: 0 auto; max-width: 600px;
            background: rgba(12, 74, 110, 0.95); backdrop-filter: blur(10px);
            color: white; padding: 12px 20px; border-radius: 50px;
            display: none; justify-content: space-between; align-items: center;
            box-shadow: 0 15px 30px rgba(12, 74, 110, 0.3);
            z-index: 100; border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .bottom-bar.show { display: flex; }

        /* æ¨™é¡Œæ¨£å¼ */
        .section-title {
            display: flex; align-items: center; justify-content: center;
            gap: 10px; font-size: 1.5rem; font-weight: 700;
            color: var(--primary); margin-bottom: 30px; position: relative;
        }
        .section-title::after {
            content: ''; display: block; width: 60px; height: 4px;
            background: var(--accent-pink); border-radius: 2px;
            position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%);
        }
        .form-section-title {
            display: flex; align-items: center; gap: 10px;
            font-size: 1.25rem; font-weight: 700; color: var(--primary);
            margin-bottom: 20px; padding-bottom: 10px;
            border-bottom: 2px dashed #e2e8f0;
        }
        /* å¼·åˆ¶æ‰€æœ‰ Lucide åœ–æ¨™ä½¿ç”¨ä¸»é¡Œè‰² */
        .section-title i, .form-section-title i, .section-title svg {
            color: var(--accent-pink) !important;
        }
        
        /* é¸é … Radio æ¨£å¼ */
        .radio-box { display: block; cursor: pointer; position: relative; margin: 2px; }
        .radio-box input:checked + div {
            background-color: var(--accent-light);
            border: 2px solid var(--accent-pink) !important; 
            color: #be185d;
            box-shadow: 0 4px 10px rgba(255, 95, 171, 0.2);
            font-weight: bold;
        }
        .radio-inner {
            border: 2px solid #e2e8f0; border-radius: 12px;
            padding: 16px; text-align: center; transition: all 0.2s;
            font-weight: 500; color: #64748b;
            box-sizing: border-box !important;
        }
        .radio-box:hover .radio-inner {
            border-color: #fbcfe8; color: var(--accent-pink);
        }

        .required-star { color: #ef4444; margin-left: 4px; font-weight: bold; }

        /* åŒ¯æ¬¾è³‡è¨Š */
        .bank-info-box {
            background-color: var(--bank-bg);
            border: 1px solid var(--bank-border);
            color: var(--primary);
        }
        .bank-info-box span.title { color: var(--bank-text); }
        .bank-info-box span.number { color: var(--primary); }

        /* é‹è²»èˆ‡è¯çµ¡å€å¡Š */
        .shipping-container {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 24px;
            position: relative;
            overflow: visible !important; 
        }
        .shipping-badge {
            position: absolute; top: -2px; right: -2px;
            background-color: var(--accent-pink);
            color: white; font-size: 0.75rem; font-weight: bold;
            padding: 6px 16px;
            border-top-right-radius: 14px; border-bottom-left-radius: 12px;
            box-shadow: -2px 2px 5px rgba(0,0,0,0.05); z-index: 5;
        }

        /* ç‡ˆç®± */
        #gallery-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85); z-index: 200;
            display: none; justify-content: center; align-items: center;
            padding: 20px; opacity: 0; transition: opacity 0.3s;
        }
        #gallery-modal.open { display: flex; opacity: 1; }
        .modal-content {
            background: white; border-radius: 20px;
            max-width: 900px; width: 100%; max-height: 90vh;
            overflow-y: auto; position: relative; padding: 20px;
        }
        .modal-close {
            position: absolute; top: 15px; right: 15px;
            background: #fff; border-radius: 50%; padding: 8px;
            cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            color: var(--text-main); z-index: 10;
        }

        /* è¼‰å…¥ä¸­é®ç½© */
        #loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.9); z-index: 300;
            display: none; flex-col; justify-content: center; align-items: center;
            text-align: center;
        }
        .spinner {
            width: 50px; height: 50px;
            border: 5px solid #f3f3f3; border-top: 5px solid var(--accent-pink);
            border-radius: 50%; animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* --- è²¼ç´™é¸æ“‡èˆ‡ç¿»ç‰Œç‰¹æ•ˆ --- */
        .sticker-grid-item {
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #fff;
        }
        .sticker-grid-item:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(255, 95, 171, 0.2);
        }
        .sticker-grid-item.selected {
            border: 3px solid var(--accent-pink);
            background-color: var(--accent-light);
            box-shadow: 0 0 15px rgba(255, 95, 171, 0.3);
            padding: 2px;
        }

        /* ç¿»ç‰Œå¡ç‰‡å®¹å™¨ */
        .flip-card {
            background-color: transparent;
            width: 75px; height: 75px; 
            perspective: 1000px; 
            cursor: pointer;
            margin: 0 auto;
            position: relative; 
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            flex-shrink: 0; 
        }
        
        /* å¡ç‰‡å…§éƒ¨ - è¨­å®š 3D è½‰å ´ */
        .flip-card-inner {
            position: relative;
            width: 100%; height: 100%;
            text-align: center;
            transform-style: preserve-3d;
            z-index: 2; 
            /* é è¨­æ˜¯å¿ƒè·³å‹•ç•« */
            animation: card-heartbeat 2s infinite ease-in-out;
            transform-origin: center center;
        }
        
        /* ç´”ç²¹çš„èºæ—‹ç¿»è½‰ï¼Œä¸ç¸®æ”¾ */
        @keyframes magic-spin-flip {
            0% {
                transform: rotateY(0deg) rotateZ(0deg);
            }
            100% {
                transform: rotateY(180deg) rotateZ(360deg);
            }
        }

        /* ç•¶åŠ ä¸Š flipped class æ™‚ï¼Œå¥—ç”¨ç¿»è½‰å‹•ç•« */
        .flip-card.flipped .flip-card-inner {
            /* 0.8s å®Œæˆç¿»è½‰ï¼Œåœåœ¨æœ€å¾Œä¸€æ ¼ */
            animation: magic-spin-flip 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        /* ç¿»å®Œå¾Œçš„è½åœ° Q å½ˆå‹•ç•« (ä½œç”¨åœ¨æœ€å¤–å±¤å®¹å™¨) */
        @keyframes land-bounce {
            0% { transform: scale(1); }
            30% { transform: scale(1.15); } /* è®Šå¤§ */
            50% { transform: scale(0.95); } /* è¢«å£“æ‰ */
            70% { transform: scale(1.05); } /* å›å½ˆ */
            100% { transform: scale(1); }
        }

        /* é€™å€‹ class æœƒç”± JS åœ¨ç¿»ç‰ŒçµæŸå¾ŒåŠ ä¸Š */
        .flip-card-landed {
            animation: land-bounce 0.5s ease-out;
        }

        @keyframes card-heartbeat {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* æ­£åé¢ */
        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%; height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .flip-card-front {
            background-color: #fff0f7;
            color: var(--accent-pink);
            border: 2px solid var(--accent-pink);
        }

        /* é–ƒäº®äº®èƒŒæ¿æ¨£å¼ (å¾®å…‰æ¾¤èƒŒæ™¯) */
        .flip-card-back {
            background: linear-gradient(135deg, #ffffff 0%, #f0f9ff 50%, #e0f2fe 100%); 
            color: var(--primary); 
            transform: rotateY(180deg);
            border: 2px solid #bae6fd;
            flex-direction: column; 
            padding: 4px;
            box-shadow: inset 0 0 15px rgba(186, 230, 253, 0.4), 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden; 
        }

        /* è¶…é–ƒäº®æµå…‰ç‰¹æ•ˆ (Sheen) */
        .flip-card-back::after {
            content: "";
            position: absolute;
            top: 0;
            left: -200%;
            width: 200%;
            height: 100%;
            background: linear-gradient(
                105deg, 
                transparent 30%, 
                rgba(255, 255, 255, 0.4) 40%, 
                rgba(255, 255, 255, 0.9) 45%, 
                rgba(255, 255, 255, 1) 50%, 
                rgba(255, 255, 255, 0.9) 55%, 
                rgba(255, 255, 255, 0.4) 60%, 
                transparent 70%
            );
            transform: skewX(-20deg);
            pointer-events: none;
        }

        /* ç¿»ç‰Œå¾Œçš„ç‹€æ…‹ï¼šå…‰æƒéå» + æ¡ƒç´…å¤–ç™¼å…‰ */
        .flip-card.flipped .flip-card-back {
            box-shadow: 0 0 15px rgba(255, 95, 171, 0.6);
            border-color: var(--accent-pink);
        }

        .flip-card.flipped .flip-card-back::after {
            /* é…åˆæ—‹è½‰æ™‚é–“ï¼Œå»¶é²ä¸€é»é»æ‰é–ƒå…‰ */
            animation: shine-sweep 0.7s cubic-bezier(0.4, 0.0, 0.2, 1) forwards 0.2s; 
        }

        @keyframes shine-sweep {
            0% { left: -200%; opacity: 0; }
            20% { opacity: 1; }
            100% { left: 100%; opacity: 0; }
        }

        /* ç¢ç´™èŠ± (Confetti) ç²’å­ */
        .confetti-particle {
            position: fixed;
            width: 6px; height: 6px;
            border-radius: 2px;
            pointer-events: none;
            z-index: 9999;
            opacity: 1;
        }

        @media (min-width: 768px) {
            .flip-card { width: 110px; height: 110px; }
        }
    </style>
</head>
<body class="pb-32">

    <!-- è¼‰å…¥ä¸­é®ç½© -->
    <div id="loading-overlay" class="hidden">
        <div class="spinner"></div>
        <h3 class="text-xl font-bold text-[#0c4a6e] mb-2">æ­£åœ¨å°‡æ‚¨çš„ç¾ç…§é€å¾€é›²ç«¯...</h3>
        <p class="text-sm text-gray-500">ç…§ç‰‡è§£æåº¦è¼ƒé«˜ï¼Œè«‹è€å¿ƒç­‰å€™ â¤ï¸</p>
        <p class="text-xs text-gray-400 mt-2">è‹¥ç…§ç‰‡è¼ƒå¤šï¼Œå¯èƒ½éœ€è¦ä¸€åˆ†é˜ï¼Œè«‹å‹¿é—œé–‰è¦–çª—</p>
    </div>

    <!-- å°è¦½åˆ— -->
    <nav class="nav-glass sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center relative">
            <span class="text-xl font-bold tracking-widest text-[#0c4a6e] cursor-pointer" onclick="switchPage('works')">é›ªè±¹è±¹è±¹</span>
            
            <div class="hidden md:flex space-x-8 text-sm font-medium text-gray-500">
                <span id="nav-desktop-works" class="nav-btn active" onclick="switchPage('works')">ä¼¼é¡ç¹ªä½œå“</span>
                <span id="nav-desktop-commission" class="nav-btn" onclick="switchPage('commission')">å§”è¨—è¡¨å–®</span>
            </div>

            <button class="md:hidden text-[#0c4a6e] hover:text-[#ff5fab] focus:outline-none p-2" onclick="toggleMenu()">
                <i data-lucide="menu" class="w-6 h-6"></i>
            </button>
        </div>

        <div id="mobile-menu" class="hidden md:hidden bg-white/95 backdrop-blur-md border-t border-[#ff5fab]/20 absolute w-full left-0 shadow-lg z-50">
            <div class="flex flex-col p-4 space-y-4 text-center">
                <span id="nav-mobile-works" class="text-[#1e293b] font-bold text-lg py-2 text-[#ff5fab]" onclick="switchPage('works'); toggleMenu()">ä¼¼é¡ç¹ªä½œå“</span>
                <span id="nav-mobile-commission" class="text-[#1e293b] font-medium text-lg py-2" onclick="switchPage('commission'); toggleMenu()">å§”è¨—è¡¨å–®</span>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <section class="hero-section">
        <div class="max-w-2xl mx-auto py-4">
            <h1 class="text-4xl md:text-5xl font-bold text-[#0c4a6e] mb-2 leading-tight flex items-center justify-center gap-2 flex-wrap">
                æ‰‹ç¹ª
                <i data-lucide="heart" class="w-10 h-10 md:w-12 md:h-12 fill-[#ff5fab] text-[#ff5fab]"></i>
                ç¥ç¦ä¼¼é¡ç¹ª
            </h1>
            <div class="flex flex-col items-center gap-1 mt-2">
                <p class="text-sm font-bold text-[#ff5fab]">â˜…ç”¨æˆ‘çš„ "é¢¨æ ¼" ç•«å‡ºæ¼‚æ¼‚äº®äº®çš„å¤§å®¶â˜…</p>
                <p class="text-sm font-bold text-[#ff5fab]">â˜…æœ€å–œæ­¡ç•«ä¸‹çœ¼ç«æ¯›å’Œè‡¥è ¶æƒ¹â˜…</p>
            </div>
        </div>
    </section>

    <!-- ç›¸ç°¿ç‡ˆç®± (äººç‰©ä¼¼é¡ç¹ª) -->
    <div id="gallery-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeGallery()">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <h3 id="gallery-title" class="text-2xl font-bold text-[#0c4a6e] mb-6 text-center border-b border-[#e2e8f0] pb-4">ç›¸ç°¿</h3>
            <div id="gallery-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Javascript will populate this -->
            </div>
        </div>
    </div>

    <!-- PAGE 1: ä¼¼é¡ç¹ªä½œå“ -->
    <div id="page-works" class="page-section active">
        <div class="portfolio-container">
            <div class="section-title">
                <i data-lucide="image"></i> ä¼¼é¡ç¹ªä½œå“
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- ç›¸ç°¿ 1 -->
                <div class="work-card group" onclick="openGallery('blessing')">
                    <img src="https://placehold.co/600x800/f0f9ff/ff5fab?text=Blessing+Portrait" alt="ç¥ç¦ä¼¼é¡ç¹ª" class="work-img">
                    <div class="p-4 text-center font-bold text-[#0c4a6e] text-lg group-hover:text-[#ff5fab] transition-colors">
                        ç¥ç¦ä¼¼é¡ç¹ª
                    </div>
                </div>

                <!-- ç›¸ç°¿ 2 -->
                <div class="work-card group" onclick="openGallery('portrait')">
                    <div class="relative">
                        <img src="p1.png" onerror="this.src='https://placehold.co/600x800/f0f9ff/ff5fab?text=Click+to+View'" alt="äººç‰©ä¼¼é¡ç¹ª" class="work-img">
                    </div>
                    <div class="p-4 text-center font-bold text-[#0c4a6e] text-lg group-hover:text-[#ff5fab] transition-colors">
                        äººåƒä¼¼é¡ç¹ª
                    </div>
                </div>

                <!-- ç›¸ç°¿ 3 -->
                <div class="work-card group" onclick="openGallery('pet')">
                    <img src="https://placehold.co/600x800/f0f9ff/ff5fab?text=Pet+Portrait" alt="å¯µç‰©ä¼¼é¡ç¹ª" class="work-img">
                    <div class="p-4 text-center font-bold text-[#0c4a6e] text-lg group-hover:text-[#ff5fab] transition-colors">
                        å¯µç‰©ä¼¼é¡ç¹ª
                    </div>
                </div>
            </div>

            <div class="mt-12 text-center">
                <button onclick="switchPage('commission'); window.scrollTo(0,0);" class="bg-white border-2 border-[#ff5fab] text-[#ff5fab] px-8 py-3 rounded-full font-bold hover:bg-[#ff5fab] hover:text-white active:bg-[#ff5fab] active:text-white transition shadow-lg transform hover:scale-105 active:scale-95 select-none flex items-center justify-center gap-2 mx-auto">
                    ä¾†å¼µä¼¼é¡ç¹ªå§ <i data-lucide="heart" class="w-5 h-5 fill-current"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- PAGE 2: å§”è¨—è¡¨å–® -->
    <div id="page-commission" class="page-section form-container">
        
        <form id="commissionForm">
            
            <!-- 1. å§”è¨—å…§å®¹ -->
            <div class="mb-14">
                <h3 class="form-section-title">
                    <i data-lucide="palette" class="text-[#ff5fab]"></i> å§”è¨—å…§å®¹èˆ‡ç…§ç‰‡ <span class="required-star">*</span>
                </h3>
                <p class="text-sm text-[#64748b] mb-6 bg-[#f0f9ff] p-4 rounded-xl border border-[#e0f2fe]">
                    <i data-lucide="info" class="w-4 h-4 inline mr-1 text-[#ff5fab]"></i>
                    è«‹ç‚ºæ¯ä¸€å¼µæƒ³è¦ç•«çš„åœ–åˆ†åˆ¥è¨­å®šäººæ•¸èˆ‡ä¸Šå‚³ç…§ç‰‡ (æ”¯æ´åŸå§‹è§£æåº¦)ã€‚
                </p>

                <div id="orders-container"></div>

                <div onclick="addOrder()" class="w-full py-4 border-2 border-dashed border-[#ff5fab] rounded-xl text-[#ff5fab] font-bold text-center cursor-pointer hover:bg-[#fff0f7] transition flex items-center justify-center gap-2 active:scale-95 select-none">
                    <i data-lucide="plus-circle" class="w-5 h-5 text-[#ff5fab]"></i> æ–°å¢ä¸€å¼µå§”è¨—åœ–
                </div>
            </div>

            <!-- 3. å¯„é€èˆ‡è¯çµ¡è³‡è¨Š -->
            <div id="shipping-section" class="mb-14 transition-all duration-500">
                <h3 class="form-section-title">
                    <i data-lucide="truck" class="text-[#ff5fab]"></i> å¯„é€èˆ‡è¯çµ¡è³‡è¨Š
                </h3>

                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-bold text-[#0c4a6e] mb-2">å§“å <span class="required-star">*</span></label>
                        <input type="text" id="name" required class="site-input" placeholder="çœŸå¯¦å§“å">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-[#0c4a6e] mb-2">IG å¸³è™Ÿ <span class="required-star">*</span></label>
                        <input type="text" id="ig_account" required class="site-input" placeholder="@your_id">
                    </div>
                </div>

                <div class="shipping-container">
                    <div class="shipping-badge">é‹è²» $60</div>
                    
                    <div class="mb-8">
                        <label class="block text-sm font-bold text-[#0c4a6e] mb-2">æ‰‹æ©Ÿè™Ÿç¢¼ <span class="required-star">*</span></label>
                        <input type="text" id="phone" required class="site-input bg-white" placeholder="09xx-xxx-xxx">
                    </div>

                    <div class="flex items-center gap-4 mb-6">
                        <div class="h-px bg-[#e2e8f0] flex-1"></div>
                        <span class="text-xs text-[#94a3b8] font-bold tracking-wider">å¯„é€æ–¹å¼æ“‡ä¸€å¡«å¯« <span class="required-star">*</span></span>
                        <div class="h-px bg-[#e2e8f0] flex-1"></div>
                    </div>

                    <div class="space-y-5">
                        <div>
                            <label class="block text-sm font-bold text-[#64748b] mb-1">ã€éƒµå¯„ã€‘åœ°å€</label>
                            <input type="text" id="shipping_address" class="site-input bg-white" placeholder="åŒ…å«éƒµéå€è™Ÿ">
                        </div>
                        <div class="text-center text-xs text-[#cbd5e1] font-bold">OR</div>
                        <div>
                            <label class="block text-sm font-bold text-[#64748b] mb-1">ã€è¶…å•†ã€‘é–€å¸‚è³‡æ–™ (7-11)</label>
                            <input type="text" id="shipping_store" class="site-input bg-white" placeholder="é–€å¸‚åç¨± / åº—è™Ÿ">
                        </div>
                    </div>
                    <p id="shipping-error" class="text-red-500 text-xs mt-3 hidden text-center font-bold bg-red-50 p-2 rounded">âš ï¸ è«‹è‡³å°‘å¡«å¯«ä¸€ç¨®å¯„é€æ–¹å¼</p>
                </div>
            </div>

            <!-- 4. ä»˜æ¬¾èˆ‡ç¢ºèª -->
            <div class="mb-8">
                <h3 class="form-section-title">
                    <i data-lucide="check-circle" class="text-[#ff5fab]"></i> ä»˜æ¬¾èˆ‡ç¢ºèª
                </h3>

                <div class="mb-8">
                    <label class="block text-sm font-bold text-[#0c4a6e] mb-2">åŒ¯æ¬¾å¸³æˆ¶å¾Œäº”ç¢¼ <span class="required-star">*</span></label>
                    <div class="bank-info-box p-5 rounded-xl mb-3 flex justify-between items-center shadow-sm">
                        <span class="text-sm font-medium title">åœ‹æ³°ä¸–è¯</span>
                        <span class="text-xl font-mono font-bold number tracking-wider">133500097892</span>
                    </div>
                    <input type="text" id="bank_last_5" required class="site-input" placeholder="è«‹å¡«å¯«å¾Œäº”ç¢¼">
                </div>

                <div class="space-y-4">
                    <div class="bg-[#f8fafc] p-5 rounded-xl text-xs text-[#64748b] space-y-1.5 leading-relaxed border border-[#e2e8f0]">
                        <p class="font-bold text-[#0c4a6e] mb-1">æ³¨æ„äº‹é …ï¼š</p>
                        <ul class="list-disc list-outside ml-4 space-y-1.5 leading-relaxed">
                            <li>ç´ æè²¼ç´™å¯é¸æ“‡æ˜¯å¦éœ€è¦ä»£è²¼ï¼Œè‹¥ä¸éœ€è¦å°‡ä¸æä¾›è²¼ç´™</li>
                            <li>ç…§ç‰‡äººç‰©é¢éƒ¨å¤ å¤§èˆ‡æ¸…æ™°</li>
                            <li>éƒµå±€æ›è™Ÿå¯„å‡ºï¼Œå¦‚æœ‰å»¶èª¤å°‡æå‰å‘ŠçŸ¥</li>
                            <li>ç¢ºèªç…§ç‰‡ä¸¦ä»˜æ¬¾å¾Œæ‰é–‹å§‹ç¹ªè£½</li>
                            <li>æ”¶åˆ°æˆå“å¾Œéº»ç…©IGç§è¨Š @joanna_snowleopard å ±å¹³å®‰å‘¦</li>
                            <li>å¦‚å¯„é€å‡ºå•é¡Œç„¡æ³•å…è²»è£œç•«ä¸€å¼µï¼Œåªèƒ½çµ¦æ‚¨ä½œå“å®Œæˆç…§ç‰‡</li>
                        </ul>
                    </div>

                    <label class="flex items-center gap-3 cursor-pointer group p-2 hover:bg-[#fff0f7] rounded-lg transition">
                        <input type="checkbox" id="notify_check" required class="w-5 h-5 accent-[#ff5fab] rounded border-gray-300">
                        <span class="text-sm text-[#475569] group-hover:text-[#ff5fab] transition">æ”¶åˆ°æˆå“å¾Œè«‹ IGç§è¨Š @joanna_snowleopard å ±å¹³å®‰å‘¦ <span class="required-star">*</span></span>
                    </label>

                    <label class="flex items-center gap-3 cursor-pointer group p-2 hover:bg-[#fff0f7] rounded-lg transition">
                        <input type="checkbox" id="terms_check" required class="w-5 h-5 accent-[#ff5fab] rounded border-gray-300">
                        <span class="text-sm font-bold text-[#0c4a6e] group-hover:text-[#ff5fab] transition">æ²’å•é¡Œï¼Œæˆ‘åŒæ„ä»¥ä¸Šäº‹é …ğŸ‘ŒğŸ» <span class="required-star">*</span></span>
                    </label>
                </div>
            </div>

        </form>
    </div>

    <!-- åº•éƒ¨ç‰ˆæ¬Š -->
    <footer class="text-center text-[#94a3b8] text-xs pb-32 font-medium">
        &copy; 2025 é›ªè±¹è±¹è±¹. All rights reserved.
    </footer>

    <!-- æµ®å‹•åƒ¹æ ¼æ¢ -->
    <div id="price-bar" class="bottom-bar hidden">
        <div class="flex flex-col">
            <span class="text-[10px] text-gray-300 tracking-wider uppercase font-bold">Estimated Total</span>
            <span class="text-2xl font-bold text-[#ff5fab]" id="display_total">$60</span>
        </div>
        <button onclick="submitFormToGoogle()" class="bg-[#ff5fab] text-white px-8 py-3 rounded-full font-bold hover:bg-white hover:text-[#ff5fab] transition shadow-[0_0_15px_rgba(255,95,171,0.4)] transform hover:scale-105 active:scale-95 select-none">
            é€å‡ºå§”è¨—
        </button>
    </div>

    <script>
        lucide.createIcons();
        let orderCount = 0;
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxLZOs5AYZT2lg0z3EQSAFRLOUAnhCce4II9gohz41wxaN7J-wbNPvDNEkz0rgtLbCTcw/exec";
        const pinkHeartSvg = `<i data-lucide="heart" class="w-10 h-10 fill-[#ff5fab] text-[#ff5fab] inline-block"></i>`;

        // â˜…â˜…â˜… è¨­å®šç›¸ç°¿åœ–ç‰‡ â˜…â˜…â˜…
        const portfolioImages = {
            blessing: {
                title: "ç¥ç¦ä¼¼é¡ç¹ªç›¸ç°¿",
                images: [
                    "https://placehold.co/800x800/f0f9ff/ff5fab?text=Blessing+1",
                    "https://placehold.co/800x800/f0f9ff/ff5fab?text=Blessing+2",
                    "https://placehold.co/800x800/f0f9ff/ff5fab?text=Blessing+3",
                    "https://placehold.co/800x800/f0f9ff/ff5fab?text=Blessing+4"
                ]
            },
            portrait: {
                title: "äººåƒä¼¼é¡ç¹ªç›¸ç°¿",
                images: ["p1.png", "p2.png", "p3.png", "p4.png"]
            },
            pet: {
                title: "å¯µç‰©ä¼¼é¡ç¹ªç›¸ç°¿",
                images: [
                    "https://placehold.co/800x800/f0f9ff/ff5fab?text=Pet+1",
                    "https://placehold.co/800x800/f0f9ff/ff5fab?text=Pet+2",
                    "https://placehold.co/800x800/f0f9ff/ff5fab?text=Pet+3",
                    "https://placehold.co/800x800/f0f9ff/ff5fab?text=Pet+4"
                ]
            }
        };

        function openGallery(type) {
            const data = portfolioImages[type];
            if (!data) return;

            document.getElementById('gallery-title').innerText = data.title;
            const grid = document.getElementById('gallery-grid');
            grid.innerHTML = ''; 

            data.images.forEach(src => {
                const img = document.createElement('img');
                img.src = src;
                img.onerror = function() { this.src = `https://placehold.co/800x800/f0f9ff/ff5fab?text=${encodeURIComponent(data.title)}`; };
                img.className = "w-full h-auto rounded-lg object-cover";
                grid.appendChild(img);
            });
            document.getElementById('gallery-modal').classList.add('open');
        }

        // --- 21çµ„è²¼ç´™æ¨¡æ“¬è³‡æ–™ ---
        const stickersData = [];
        const blessings = [
            { icon: "ğŸ’°", text: "è²¡æºæ»¾æ»¾" }, 
            { icon: pinkHeartSvg, text: "æ„›æƒ…é †åˆ©" }, 
            { icon: "ğŸŒ¸", text: "å¿ƒèŠ±æ€’æ”¾" },
            { icon: "âœ¨", text: "é–ƒé–ƒç™¼å…‰" }, { icon: "ğŸ€", text: "å¹¸é‹ç›¸éš¨" }, { icon: "ğŸ’ª", text: "èº«é«”å¥åº·" },
            { icon: "ğŸŒˆ", text: "æœªä¾†å¯æœŸ" }, { icon: "ğŸ", text: "å¹³å¹³å®‰å®‰" }, { icon: "ğŸ‰", text: "å¤©å¤©é–‹å¿ƒ" },
            { icon: "â˜€ï¸", text: "å……æ»¿å¸Œæœ›" }, { icon: "ğŸ±", text: "è²“è‚¥å®¶æ½¤" }, { icon: "ğŸ¶", text: "å¿ èª é™ªä¼´" }
        ];

        for(let i=1; i<=21; i++) {
            let elements = [];
            for(let j=0; j<3; j++) {
                elements.push(blessings[Math.floor(Math.random() * blessings.length)]);
            }
            stickersData.push({
                id: i,
                imageUrl: `https://placehold.co/200x200/fff0f7/ff5fab?text=Sticker+${i}`,
                name: `è²¼ç´™ ${i}è™Ÿ`,
                elements: elements
            });
        }

        const orderStates = {};

        document.addEventListener('DOMContentLoaded', () => { 
            addOrder(); 
            switchPage('works');
            
            document.getElementById('gallery-modal').addEventListener('click', function(e) {
                if(e.target === this) closeGallery();
            });
        });

        // --- æ ¸å¿ƒé‚è¼¯ä¿®æ”¹ï¼šå°‡æ‰€æœ‰åŠŸèƒ½ç¶å®šåˆ°ç‰¹å®š orderId ---

        function toggleStickerSection(show, orderId) {
            const area = document.getElementById(`sticker-interactive-area-${orderId}`);
            if (show) {
                area.classList.remove('hidden');
                renderStickers(orderId);
                setTimeout(() => area.scrollIntoView({behavior: "smooth", block: "start"}), 100);
            } else {
                area.classList.add('hidden');
                if (orderStates[orderId]) {
                    orderStates[orderId].selectedSticker = null;
                    orderStates[orderId].flippedCount = 0;
                }
                document.getElementById(`reveal-section-${orderId}`).classList.add('hidden');
                document.getElementById(`blessing-text-container-${orderId}`).classList.add('opacity-0');
            }
        }

        function renderStickers(orderId) {
            const grid = document.getElementById(`sticker-grid-${orderId}`);
            if(grid.children.length > 0) return;

            grid.innerHTML = '';
            stickersData.forEach(sticker => {
                const div = document.createElement('div');
                div.className = 'sticker-grid-item';
                div.id = `sticker-item-${orderId}-${sticker.id}`;
                div.innerHTML = `
                    <img src="${sticker.imageUrl}" alt="è²¼ç´™é¸é …" class="w-full h-auto object-cover aspect-square pointer-events-none">
                `;
                div.onclick = () => selectSticker(sticker.id, orderId);
                grid.appendChild(div);
            });
        }

        function selectSticker(stickerId, orderId) {
            const state = orderStates[orderId];
            if (state.selectedSticker && state.selectedSticker.id === stickerId) return;
            if (state.flippedCount > 0) {
                 alert("é¸å®šå¾Œä¸å¯æ›´æ›å–”ï¼è«‹ç›´æ¥ç¿»é–‹æ„›å¿ƒæ¥æ”¶ç¥ç¦ â¤");
                 return;
            }

            const grid = document.getElementById(`sticker-grid-${orderId}`);
            grid.querySelectorAll('.sticker-grid-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`sticker-item-${orderId}-${stickerId}`).classList.add('selected');

            state.selectedSticker = stickersData.find(s => s.id === stickerId);
            
            const revealSec = document.getElementById(`reveal-section-${orderId}`);
            revealSec.classList.remove('hidden');
            revealSec.scrollIntoView({behavior: "smooth", block: "center"});
            
            const container = document.getElementById(`cards-container-${orderId}`);
            container.innerHTML = '';
            state.flippedCount = 0;
            document.getElementById(`blessing-text-container-${orderId}`).classList.add('opacity-0');
            document.getElementById(`blessing-title-wrapper-${orderId}`).classList.add('opacity-0');

            for(let i=0; i<3; i++) {
                const el = state.selectedSticker.elements[i];
                const cardIndex = i + 1;
                
                // â˜…â˜…â˜… å¡ç‰‡çµæ§‹ä¿®æ”¹ï¼šä½¿ç”¨ justify-end å’Œ pb-3 å°é½Šåº•éƒ¨ â˜…â˜…â˜…
                const cardHTML = `
                    <div class="flip-card" id="flip-card-${orderId}-${cardIndex}" onclick="flipCard(event, ${cardIndex}, ${orderId})">
                        <div class="flip-card-inner" id="card-inner-${orderId}-${cardIndex}">
                            <div class="flip-card-front">
                                <i data-lucide="heart" class="w-7 h-7 md:w-10 md:h-10 fill-current text-[#ff5fab]"></i>
                            </div>
                            <div class="flip-card-back flex flex-col items-center justify-end pb-3 gap-0">
                                <span class="text-3xl md:text-5xl drop-shadow-sm flex items-center justify-center h-10 md:h-14">${el.icon}</span>
                                <span class="text-[10px] md:text-sm font-bold text-[#0c4a6e] tracking-wide leading-none mt-1">${el.text}</span>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += cardHTML;
            }
            lucide.createIcons();
        }

        function flipCard(event, cardIndex, orderId) {
            const inner = document.getElementById(`card-inner-${orderId}-${cardIndex}`);
            const cardEl = document.getElementById(`flip-card-${orderId}-${cardIndex}`);
            const state = orderStates[orderId];
            
            if(inner.parentElement.classList.contains('flipped')) return;

            inner.parentElement.classList.add('flipped');
            state.flippedCount++;

            setTimeout(() => {
                cardEl.classList.remove('flip-card-landed');
                void cardEl.offsetWidth; 
                cardEl.classList.add('flip-card-landed');
                createConfetti(cardEl);

                if (state.flippedCount === 3) {
                    setTimeout(() => {
                        const words = state.selectedSticker.elements.map(e => e.text).join('ã€');
                        const textContainer = document.getElementById(`blessing-text-container-${orderId}`);
                        const titleWrapper = document.getElementById(`blessing-title-wrapper-${orderId}`);
                        
                        document.getElementById(`blessing-words-${orderId}`).innerText = `${words}`;
                        textContainer.classList.remove('opacity-0');
                        titleWrapper.classList.remove('opacity-0');
                        lucide.createIcons();
                    }, 600);
                }
            }, 800);
        }

        function createConfetti(element) {
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            const colors = ['#ff5fab', '#bae6fd', '#fbcfe8', '#38bdf8', '#fbbf24'];
            const particleCount = 30;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('confetti-particle');
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                particle.style.left = `${centerX}px`;
                particle.style.top = `${centerY}px`;
                document.body.appendChild(particle);

                const angle = Math.random() * Math.PI * 2;
                const velocity = 30 + Math.random() * 80;
                const tx = Math.cos(angle) * velocity;
                const ty = Math.sin(angle) * velocity;

                const animation = particle.animate([
                    { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                    { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
                ], {
                    duration: 600 + Math.random() * 400,
                    easing: 'cubic-bezier(0, .9, .57, 1)',
                    fill: 'forwards'
                });
                animation.onfinish = () => particle.remove();
            }
        }

        // --- é é¢é‚è¼¯ ---
        function toggleMenu() { document.getElementById('mobile-menu').classList.toggle('hidden'); }
        function closeGallery() { document.getElementById('gallery-modal').classList.remove('open'); }
        function switchPage(pageId) {
            document.getElementById('page-works').classList.remove('active');
            document.getElementById('page-commission').classList.remove('active');
            document.getElementById('price-bar').classList.remove('show');
            document.getElementById('price-bar').classList.add('hidden');
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('nav-mobile-works').classList.remove('text-[#ff5fab]', 'font-bold');
            document.getElementById('nav-mobile-commission').classList.remove('text-[#ff5fab]', 'font-bold');
            document.getElementById('page-' + pageId).classList.add('active');

            if(pageId === 'works') {
                document.getElementById('nav-desktop-works').classList.add('active');
                document.getElementById('nav-mobile-works').classList.add('text-[#ff5fab]', 'font-bold');
            } else {
                document.getElementById('nav-desktop-commission').classList.add('active');
                document.getElementById('nav-mobile-commission').classList.add('text-[#ff5fab]', 'font-bold');
                document.getElementById('price-bar').classList.remove('hidden');
                document.getElementById('price-bar').classList.add('show');
            }
            window.scrollTo(0, 0);
        }

        function addOrder() {
            orderCount++;
            orderStates[orderCount] = { selectedSticker: null, flippedCount: 0 };

            const container = document.getElementById('orders-container');
            const div = document.createElement('div');
            div.className = 'order-card order-card-active'; 
            div.id = `order-${orderCount}`;
            
            div.innerHTML = `
                <div class="flex justify-between items-center mb-4 pb-2 border-b border-dashed border-[#ff5fab]">
                    <span class="font-bold text-[#0c4a6e] text-lg">å§”è¨—åœ– #${orderCount}</span>
                    ${orderCount > 1 ? `<button type="button" class="text-[#94a3b8] hover:text-red-500 text-sm flex items-center gap-1 transition select-none" onclick="removeOrder(${orderCount})"><i data-lucide="trash-2" class="w-4 h-4 text-[#ff5fab]"></i> ç§»é™¤</button>` : ''}
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div class="bg-[#f0f9ff] p-4 rounded-lg border border-[#e0f2fe] flex flex-col items-center">
                        <span class="text-xs font-bold text-[#0284c7] mb-2">äººç‰© ($500)</span>
                        <div class="flex items-center gap-4">
                            <div class="qty-btn" onclick="updateQty('people', ${orderCount}, -1)">-</div>
                            <input type="text" id="qty-people-${orderCount}" value="0" class="w-10 text-center bg-transparent font-bold text-lg text-[#0c4a6e]" readonly>
                            <div class="qty-btn" onclick="updateQty('people', ${orderCount}, 1)">+</div>
                        </div>
                    </div>
                    <div class="bg-[#f0f9ff] p-4 rounded-lg border border-[#e0f2fe] flex flex-col items-center">
                        <span class="text-xs font-bold text-[#0284c7] mb-2">å¯µç‰© ($450)</span>
                        <div class="flex items-center gap-4">
                            <div class="qty-btn" onclick="updateQty('pet', ${orderCount}, -1)">-</div>
                            <input type="text" id="qty-pet-${orderCount}" value="0" class="w-10 text-center bg-transparent font-bold text-lg text-[#0c4a6e]" readonly>
                            <div class="qty-btn" onclick="updateQty('pet', ${orderCount}, 1)">+</div>
                        </div>
                    </div>
                </div>

                <div class="space-y-3 mb-6">
                    <div class="relative">
                        <input type="file" id="file-${orderCount}" multiple accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" onchange="updateFileName(this, ${orderCount})">
                        <div class="w-full py-4 border-2 border-dashed border-[#cbd5e1] rounded-xl text-[#64748b] text-sm text-center hover:border-[#ff5fab] hover:text-[#ff5fab] hover:bg-[#f0f9ff] transition flex flex-col items-center justify-center gap-1" id="upload-label-${orderCount}">
                            <i data-lucide="image-plus" class="w-6 h-6 mb-1 text-[#ff5fab]"></i> 
                            <span class="font-medium">é»æ“Šä¸Šå‚³åƒè€ƒç…§ç‰‡</span>
                            <span class="text-xs text-[#94a3b8] font-normal">æ”¯æ´å¤šå¼µä¸Šå‚³ (4Kä¸å£“ç¸®)</span>
                        </div>
                    </div>
                    <input type="text" id="combo-${orderCount}" class="site-input text-sm" placeholder="çµ„åˆå‚™è¨»ï¼šä¾‹å¦‚ 1äººæŠ±è‘—1è²“">
                </div>

                <div class="pt-4 border-t border-[#e2e8f0]">
                    <label class="block font-bold text-[#0c4a6e] mb-3 flex items-center gap-2">
                        <i data-lucide="sparkles" class="w-4 h-4 text-[#ff5fab]"></i> æ˜¯å¦éœ€è¦è²¼ç´™èˆ‡ç¥ç¦ï¼Ÿ
                    </label>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <label class="radio-box">
                            <!-- â˜…â˜…â˜… ä¿®æ”¹ï¼šä¸é é¸ä»»ä½•é …ç›® â˜…â˜…â˜… -->
                            <input type="radio" name="sticker-${orderCount}" value="ä¸ç”¨è²¼ç´™" class="hidden" onchange="toggleStickerSection(false, ${orderCount})">
                            <div class="radio-inner">ä¸ç”¨è²¼ç´™</div>
                        </label>
                        <label class="radio-box">
                            <input type="radio" name="sticker-${orderCount}" value="å¥½å‘€" class="hidden" onchange="toggleStickerSection(true, ${orderCount})">
                            <div class="radio-inner">å¥½å‘€~</div>
                        </label>
                    </div>

                    <div id="sticker-interactive-area-${orderCount}" class="hidden mt-4 border-t-2 border-dashed border-[#e2e8f0] pt-4">
                        <h4 class="font-bold text-[#0c4a6e] mb-2 flex items-center gap-2 text-sm">
                            <i data-lucide="smile" class="w-4 h-4 text-[#ff5fab]"></i> è«‹ç›´è¦ºé¸ä¸€å¼µæœ€å–œæ­¡çš„åœ–
                        </h4>
                        
                        <div id="sticker-grid-${orderCount}" class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 mb-6"></div>

                        <div id="reveal-section-${orderCount}" class="hidden bg-[#fff0f7] p-4 rounded-xl text-center transition-all duration-500 mt-4">
                            <p class="text-[#0c4a6e] font-bold mb-4 text-sm md:text-base">è«‹é»æ“Šä¸‹æ–¹çš„æ„›å¿ƒï¼Œæ¥æ”¶æ‚¨çš„ç¥ç¦ âœ¨</p>
                            <div id="cards-container-${orderCount}" class="flex justify-center gap-3 md:gap-8 mb-4 relative"></div>
                            
                            <div class="flex items-center justify-center gap-2 mb-2 mt-4 opacity-0 transition-opacity duration-500" id="blessing-title-wrapper-${orderCount}">
                                <i data-lucide="heart" class="w-5 h-5 fill-[#ff5fab] text-[#ff5fab]"></i>
                                <p class="text-[#ff5fab] font-bold text-lg">æ‚¨çš„å°ˆå±¬ç¥ç¦</p>
                                <i data-lucide="heart" class="w-5 h-5 fill-[#ff5fab] text-[#ff5fab]"></i>
                            </div>
                            <div id="blessing-text-container-${orderCount}" class="opacity-0 transition-opacity duration-1000 px-2 overflow-hidden">
                                <p id="blessing-words-${orderCount}" class="text-[#0c4a6e] font-bold text-base md:text-xl whitespace-nowrap overflow-visible"></p>
                            </div>
                        </div>

                        <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4 bg-white p-4 rounded-xl border-2 border-[#e2e8f0] w-full overflow-hidden">
                            <div class="min-w-0">
                                <label class="block text-sm font-bold text-[#0c4a6e] mb-2">è¢«ç•«å°è±¡å§“å <span class="required-star">*</span></label>
                                <input type="text" id="subject_name-${orderCount}" class="site-input" placeholder="ä¾‹å¦‚ï¼šç‹å°æ˜">
                            </div>
                            <div class="min-w-0">
                                <label class="block text-sm font-bold text-[#0c4a6e] mb-2" id="subject_birthday_label-${orderCount}">è¢«ç•«å°è±¡ç”Ÿæ—¥ <span class="text-xs text-gray-400 font-normal">(ä¸çŸ¥ç”Ÿæ—¥å¯ä¸å¡«)</span></label>
                                <input type="date" id="subject_birthday-${orderCount}" class="site-input cursor-pointer">
                            </div>
                        </div>
                    </div>
                </div>
            `;
            container.appendChild(div);
            lucide.createIcons();
            calculateTotal();
            updateBirthdayRequirement(orderCount); // åˆå§‹åŒ–ç”Ÿæ—¥æª¢æŸ¥
        }

        function removeOrder(id) {
            const el = document.getElementById(`order-${id}`);
            if (el) { el.remove(); calculateTotal(); delete orderStates[id]; }
        }

        function updateQty(type, id, change) {
            const input = document.getElementById(`qty-${type}-${id}`);
            let val = parseInt(input.value) || 0;
            val += change;
            if (val < 0) val = 0;
            input.value = val;
            calculateTotal();
            updateBirthdayRequirement(id);
        }

        function updateBirthdayRequirement(id) {
            const peopleQty = parseInt(document.getElementById(`qty-people-${id}`).value) || 0;
            const label = document.getElementById(`subject_birthday_label-${id}`);
            if (!label) return;

            if (peopleQty > 0) {
                // æœ‰äººç‰©ï¼šå¿…å¡«ï¼Œç´…è‰²æ˜Ÿè™Ÿ
                label.innerHTML = `è¢«ç•«å°è±¡ç”Ÿæ—¥ <span class="required-star">*</span>`;
            } else {
                // åªæœ‰å¯µç‰© (æˆ–éƒ½æ˜¯0)ï¼šä¸å¿…å¡«ï¼Œç°è‰²æç¤º
                label.innerHTML = `è¢«ç•«å°è±¡ç”Ÿæ—¥ <span class="text-xs text-gray-400 font-normal">(ä¸çŸ¥ç”Ÿæ—¥å¯ä¸å¡«)</span>`;
            }
        }

        function updateFileName(input, id) {
            const label = document.getElementById(`upload-label-${id}`);
            if (input.files && input.files.length > 0) {
                label.innerHTML = `<i data-lucide="check-circle" class="w-6 h-6 mb-1 text-[#ff5fab]"></i><span class="font-bold text-[#ff5fab]">å·²é¸æ“‡ ${input.files.length} å¼µç…§ç‰‡</span>`;
                label.classList.add('border-[#ff5fab]', 'text-[#ff5fab]', 'bg-[#fff0f7]');
                label.classList.remove('border-[#cbd5e1]', 'text-[#64748b]');
            } else {
                label.innerHTML = `
                    <i data-lucide="image-plus" class="w-6 h-6 mb-1 text-[#ff5fab]"></i> 
                    <span class="font-medium">é»æ“Šä¸Šå‚³åƒè€ƒç…§ç‰‡</span>
                    <span class="text-xs text-[#94a3b8] font-normal">æ”¯æ´å¤šå¼µä¸Šå‚³ (4Kä¸å£“ç¸®)</span>
                `;
                label.classList.remove('border-[#ff5fab]', 'text-[#ff5fab]', 'bg-[#fff0f7]');
                label.classList.add('border-[#cbd5e1]', 'text-[#64748b]');
            }
        }

        function calculateTotal() {
            let total = 60; 
            const cards = document.querySelectorAll('.order-card');
            cards.forEach(card => {
                const people = parseInt(card.querySelector('input[id^="qty-people"]').value) || 0;
                const pet = parseInt(card.querySelector('input[id^="qty-pet"]').value) || 0;
                total += (people * 500) + (pet * 450);
            });
            document.getElementById('display_total').innerText = '$' + total;
            return total;
        }

        function validateForm() {
            const address = document.getElementById('shipping_address').value.trim();
            const store = document.getElementById('shipping_store').value.trim();
            const errorMsg = document.getElementById('shipping-error');

            let hasContent = false;
            let isValid = true;

            const cards = document.querySelectorAll('.order-card');
            for(let i=0; i<cards.length; i++) {
                const card = cards[i];
                const orderId = card.id.split('-')[1]; 
                
                const p = parseInt(document.getElementById(`qty-people-${orderId}`).value) || 0;
                const a = parseInt(document.getElementById(`qty-pet-${orderId}`).value) || 0;
                
                if (p === 0 && a === 0) {
                    alert(`ã€å§”è¨—åœ– #${orderId}ã€‘è«‹è¨­å®šäººæ•¸æˆ–å¯µç‰©æ•¸é‡ï¼`);
                    card.scrollIntoView({behavior: "smooth", block: "center"});
                    card.style.borderColor = "#ef4444";
                    setTimeout(() => card.style.borderColor = "#ff5fab", 2000);
                    isValid = false; break;
                }
                
                hasContent = true;

                const stickerChoice = document.querySelector(`input[name="sticker-${orderId}"]:checked`);
                // â˜…â˜…â˜… é©—è­‰ï¼šå¿…é ˆé¸æ“‡è¦æˆ–ä¸è¦è²¼ç´™ â˜…â˜…â˜…
                if (!stickerChoice) {
                    alert(`ã€å§”è¨—åœ– #${orderId}ã€‘è«‹é¸æ“‡æ˜¯å¦éœ€è¦è²¼ç´™ï¼`);
                    card.querySelector('.radio-box').scrollIntoView({behavior: "smooth", block: "center"});
                    isValid = false; break;
                }

                if(stickerChoice && stickerChoice.value === "å¥½å‘€") {
                    if (!orderStates[orderId].selectedSticker) {
                        alert(`ã€å§”è¨—åœ– #${orderId}ã€‘æ‚¨é¸æ“‡äº†è¦è²¼ç´™ï¼Œè«‹é¸ä¸€å¼µåœ–å–”ï¼`);
                        document.getElementById(`sticker-interactive-area-${orderId}`).scrollIntoView({behavior: "smooth"});
                        isValid = false; break;
                    }
                    const subjName = document.getElementById(`subject_name-${orderId}`);
                    if (!subjName.value) {
                        alert(`ã€å§”è¨—åœ– #${orderId}ã€‘è«‹å¡«å¯«è¢«ç•«å°è±¡å§“åï¼`);
                        subjName.classList.add('input-error');
                        setTimeout(() => subjName.classList.remove('input-error'), 500);
                        subjName.focus();
                        isValid = false; break;
                    }
                    const subjBirthday = document.getElementById(`subject_birthday-${orderId}`);
                    if (p > 0 && !subjBirthday.value) {
                        alert(`ã€å§”è¨—åœ– #${orderId}ã€‘ç•«äººç‰©æ™‚ï¼Œè«‹å¡«å¯«ç”Ÿæ—¥å–”ï¼`);
                        subjBirthday.classList.add('input-error');
                        setTimeout(() => subjBirthday.classList.remove('input-error'), 500);
                        subjBirthday.focus();
                        isValid = false; break;
                    }
                }
            }

            if (!isValid) return false;

            if (!address && !store) {
                errorMsg.classList.remove('hidden');
                errorMsg.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return false;
            }
            if (!document.getElementById('name').value || !document.getElementById('phone').value || !document.getElementById('ig_account').value || !document.getElementById('bank_last_5').value) {
                alert("è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½ï¼");
                return false;
            }
            if(!document.getElementById('notify_check').checked || !document.getElementById('terms_check').checked) {
                alert("è«‹å‹¾é¸ç¢ºèªäº‹é …ï¼");
                return false;
            }
            
            errorMsg.classList.add('hidden');
            return true;
        }

        const fileToBase64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });

        async function submitFormToGoogle() {
            if (!validateForm()) return;
            const loading = document.getElementById('loading-overlay');
            loading.classList.remove('hidden');
            loading.style.display = 'flex';

            try {
                // æª¢æŸ¥ç¸½æª”æ¡ˆå¤§å° (ç´„ 25MB)
                let totalSize = 0;
                const allFileInputs = document.querySelectorAll('input[type="file"]');
                allFileInputs.forEach(input => {
                    if (input.files) {
                        for (let i = 0; i < input.files.length; i++) {
                            totalSize += input.files[i].size;
                        }
                    }
                });

                if (totalSize > 25 * 1024 * 1024) {
                    if(!confirm("âš ï¸ æ‚¨çš„ç…§ç‰‡æª”æ¡ˆç¸½å’Œè¼ƒå¤§ (>25MB)ï¼Œå¯èƒ½æœƒå°è‡´å‚³é€å¤±æ•—ã€‚\n\nå»ºè­°æ‚¨ã€Œåˆ†æ‰¹ä¸‹å–®ã€æˆ–å°‡ç…§ç‰‡ä¸Šå‚³è‡³é›²ç«¯å¾Œæä¾›é€£çµã€‚\n\nè¦å˜—è©¦ç¹¼çºŒå‚³é€å—ï¼Ÿ")) {
                        loading.classList.add('hidden');
                        return;
                    }
                }

                let orderDetails = [];
                let allFiles = [];
                let combinedStickerInfo = [];
                let combinedSubjectNames = [];
                let combinedSubjectBirthdays = [];

                const cards = document.querySelectorAll('.order-card');
                for (let i = 0; i < cards.length; i++) {
                    const card = cards[i];
                    const orderId = card.id.split('-')[1];
                    const p = card.querySelector(`input[id^="qty-people"]`).value;
                    const a = card.querySelector(`input[id^="qty-pet"]`).value;
                    const combo = card.querySelector(`input[id^="combo"]`).value;
                    const fileInput = card.querySelector(`input[type="file"]`);
                    
                    if (p > 0 || a > 0) {
                        orderDetails.push(`ã€å§”è¨—åœ– ${orderId}ã€‘: äºº${p}/å¯µ${a} (${combo || "ç„¡å‚™è¨»"})`);
                        
                        const stickerChoice = document.querySelector(`input[name="sticker-${orderId}"]:checked`).value;
                        if (stickerChoice === "å¥½å‘€" && orderStates[orderId].selectedSticker) {
                            const s = orderStates[orderId].selectedSticker;
                            const bless = s.elements.map(e => e.text).join('/');
                            combinedStickerInfo.push(`ã€åœ–${orderId}ã€‘${s.name}: ${bless}`);
                            
                            const sName = document.getElementById(`subject_name-${orderId}`).value;
                            const sBirth = document.getElementById(`subject_birthday-${orderId}`).value;
                            combinedSubjectNames.push(`ã€åœ–${orderId}ã€‘${sName}`);
                            combinedSubjectBirthdays.push(`ã€åœ–${orderId}ã€‘${sBirth || "ç„¡"}`);
                        } else {
                            combinedStickerInfo.push(`ã€åœ–${orderId}ã€‘ç„¡`);
                            combinedSubjectNames.push(`ã€åœ–${orderId}ã€‘ç„¡`);
                            combinedSubjectBirthdays.push(`ã€åœ–${orderId}ã€‘ç„¡`);
                        }

                        if (fileInput.files.length > 0) {
                            for (let j = 0; j < fileInput.files.length; j++) {
                                const file = fileInput.files[j];
                                const base64 = await fileToBase64(file);
                                allFiles.push({
                                    name: `Order${orderId}_${file.name}`,
                                    type: file.type,
                                    base64: base64
                                });
                            }
                        }
                    }
                }

                const payload = {
                    name: document.getElementById('name').value,
                    ig_account: document.getElementById('ig_account').value,
                    phone: document.getElementById('phone').value,
                    shipping_info: document.getElementById('shipping_address').value || document.getElementById('shipping_store').value,
                    bank_last_5: document.getElementById('bank_last_5').value,
                    total_amount: calculateTotal(),
                    sticker: combinedStickerInfo.join("\n"),
                    subject_name: combinedSubjectNames.join("\n"),
                    subject_birthday: combinedSubjectBirthdays.join("\n"),
                    order_details: orderDetails.join("\n"),
                    files: allFiles
                };

                await fetch(SCRIPT_URL, {
                    method: 'POST',
                    body: JSON.stringify(payload),
                    mode: 'no-cors'
                });

                loading.classList.add('hidden');
                alert('å§”è¨—å–®å·²é€å‡ºï¼æˆ‘å€‘æœƒç›¡å¿«èˆ‡æ‚¨è¯ç¹« â¤');
                window.location.reload();

            } catch (error) {
                loading.classList.add('hidden');
                console.error(error);
                alert('å‚³é€å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ï¼Œæˆ–ç›´æ¥ IG ç§è¨Šæˆ‘å€‘ï¼');
            }
        }
    </script>
</body>
</html>
